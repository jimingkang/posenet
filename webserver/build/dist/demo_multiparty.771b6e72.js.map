{"version":3,"sources":["api/demo_multiparty.js"],"names":["layout","activeBox","aspectRatio","maxCALLERS","numVideoOBJS","getIdOfBox","boxNum","reshapeFull","parentw","parenth","left","top","width","height","reshapeTextEntryBox","reshapeTextEntryField","easyrtc","dontAddCloseButtons","margin","reshapeToFullSize","setThumbSizeAspect","percentSize","percentLeft","percentTop","aspect","Math","floor","setThumbSize","setThumbSizeButton","imagew","imageh","sharedVideoWidth","sharedVideoHeight","reshape1of2","reshape2of2","reshape1of3","reshape2of3","reshape3of3","reshape1of4","reshape2of4","reshape3of4","reshape4of4","boxUsed","connectCount","setSharedVideoSize","w","h","sizeBy","fullsize","numVideos","min","reshapeThumbs","killButtonReshaper","muteButtonReshaper","reshapeTextEntryButton","handleWindowResize","fullpage","document","getElementById","style","window","innerWidth","innerHeight","getConnectionCount","applyReshape","obj","myReshape","reshapeMe","round","n","childNodes","length","i","childNode","setReshaper","elementId","reshapeFn","element","alert","collapseToThumbHelper","id","zIndex","display","collapseToThumb","updateMuteImage","toggle","muteButton","videoObject","isMuted","muted","src","expandThumb","whichBox","lastActiveBox","prepVideoBox","onclick","killActiveBox","easyrtcid","getIthCaller","setTimeout","hangup","muteActiveBox","callEverybodyElse","roomName","otherPeople","setRoomOccupantListener","list","push","establishConnection","position","call","callSuccess","callFailure","errorCode","errorText","showError","loginSuccess","cancelText","sendText","e","stringToSend","value","sendPeerMessage","showTextEntry","focus","showMessage","startX","startY","content","fullPage","fullW","parseInt","offsetWidth","fullH","offsetHeight","centerEndX","centerEndY","cloudObject","createElement","appendChild","onload","textObject","removeCloud","removeChild","opacity","className","fontSize","createTextNode","messageListener","msgType","startArea","offsetLeft","offsetTop","appInit","onresize","easyApp","setPeerListener","setDisconnectListener","setOnCall","slot","console","log","visibility","setOnHangup"],"mappings":"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","file":"demo_multiparty.771b6e72.js","sourceRoot":"..","sourcesContent":["\r\nvar activeBox = -1;  // nothing selected\r\nvar aspectRatio = 4/3;  // standard definition video aspect ratio\r\nvar maxCALLERS = 3;\r\nvar numVideoOBJS = maxCALLERS+1;\r\nvar layout;\r\n\r\n\r\neasyrtc.dontAddCloseButtons(true);\r\n  function getIdOfBox(boxNum) {\r\n    return \"box\" + boxNum;\r\n}\r\n function reshapeFull(parentw, parenth) {\r\n    return {\r\n        left:0,\r\n        top:0,\r\n        width:parentw,\r\n        height:parenth\r\n    };\r\n}\r\n\r\n function reshapeTextEntryBox(parentw, parenth) {\r\n    return {\r\n        left:parentw/4,\r\n        top:parenth/4,\r\n        width:parentw/2,\r\n        height: parenth/4\r\n    }\r\n}\r\n\r\n function reshapeTextEntryField(parentw, parenth) {\r\n    return {\r\n        width:parentw -40\r\n    }\r\n}\r\n\r\nvar margin = 20;\r\n\r\n function reshapeToFullSize(parentw, parenth) {\r\n    var left, top, width, height;\r\n    var margin= 20;\r\n\r\n    if( parentw < parenth*aspectRatio){\r\n        width = parentw -margin;\r\n        height = width/aspectRatio;\r\n    }\r\n    else {\r\n        height = parenth-margin;\r\n        width = height*aspectRatio;\r\n    }\r\n    left = (parentw - width)/2;\r\n    top = (parenth - height)/2;\r\n    return {\r\n        left:left,\r\n        top:top,\r\n        width:width,\r\n        height:height\r\n    };\r\n}\r\n\r\n//\r\n// a negative percentLeft is interpreted as setting the right edge of the object\r\n// that distance from the right edge of the parent.\r\n// Similar for percentTop.\r\n//\r\n function setThumbSizeAspect(percentSize, percentLeft, percentTop, parentw, parenth, aspect) {\r\n\r\n    var width, height;\r\n    if( parentw < parenth*aspectRatio){\r\n        width = parentw * percentSize;\r\n        height = width/aspect;\r\n    }\r\n    else {\r\n        height = parenth * percentSize;\r\n        width = height*aspect;\r\n    }\r\n    var left;\r\n    if( percentLeft < 0) {\r\n        left = parentw - width;\r\n    }\r\n    else {\r\n        left = 0;\r\n    }\r\n    left += Math.floor(percentLeft*parentw);\r\n    var top = 0;\r\n    if( percentTop < 0) {\r\n        top = parenth - height;\r\n    }\r\n    else {\r\n        top = 0;\r\n    }\r\n    top += Math.floor(percentTop*parenth);\r\n    return {\r\n        left:left,\r\n        top:top,\r\n        width:width,\r\n        height:height\r\n    };\r\n}\r\n\r\n\r\n function setThumbSize(percentSize, percentLeft, percentTop, parentw, parenth) {\r\n    return setThumbSizeAspect(percentSize, percentLeft, percentTop, parentw, parenth, aspectRatio);\r\n}\r\n\r\n function setThumbSizeButton(percentSize, percentLeft, percentTop, parentw, parenth, imagew, imageh) {\r\n    return setThumbSizeAspect(percentSize, percentLeft, percentTop, parentw, parenth, imagew/imageh);\r\n}\r\n\r\n\r\nvar sharedVideoWidth  = 1;\r\nvar sharedVideoHeight = 1;\r\n\r\n function reshape1of2(parentw, parenth) {\r\n    if( layout== 'p' ) {\r\n        return {\r\n            left: (parentw-sharedVideoWidth)/2,\r\n            top:  (parenth -sharedVideoHeight*2)/3,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        };\r\n    }\r\n    else {\r\n        return{\r\n            left: (parentw-sharedVideoWidth*2)/3,\r\n            top:  (parenth -sharedVideoHeight)/2,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        }\r\n    }\r\n}\r\n\r\n\r\n\r\n function reshape2of2(parentw, parenth){\r\n    if( layout== 'p' ) {\r\n        return {\r\n            left: (parentw-sharedVideoWidth)/2,\r\n            top:  (parenth -sharedVideoHeight*2)/3 *2 + sharedVideoHeight,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        };\r\n    }\r\n    else {\r\n        return{\r\n            left: (parentw-sharedVideoWidth*2)/3 *2 + sharedVideoWidth,\r\n            top:  (parenth -sharedVideoHeight)/2,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        }\r\n    }\r\n}\r\n\r\n function reshape1of3(parentw, parenth) {\r\n    if( layout== 'p' ) {\r\n        return {\r\n            left: (parentw-sharedVideoWidth)/2,\r\n            top:  (parenth -sharedVideoHeight*3)/4 ,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        };\r\n    }\r\n    else {\r\n        return{\r\n            left: (parentw-sharedVideoWidth*2)/3,\r\n            top:  (parenth -sharedVideoHeight*2)/3,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        }\r\n    }\r\n}\r\n\r\n function reshape2of3(parentw, parenth){\r\n    if( layout== 'p' ) {\r\n        return {\r\n            left: (parentw-sharedVideoWidth)/2,\r\n            top:  (parenth -sharedVideoHeight*3)/4*2+ sharedVideoHeight,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        };\r\n    }\r\n    else {\r\n        return{\r\n            left: (parentw-sharedVideoWidth*2)/3*2+sharedVideoWidth,\r\n            top:  (parenth -sharedVideoHeight*2)/3,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        }\r\n    }\r\n}\r\n\r\n function reshape3of3(parentw, parenth) {\r\n    if( layout== 'p' ) {\r\n        return {\r\n            left: (parentw-sharedVideoWidth)/2,\r\n            top:  (parenth -sharedVideoHeight*3)/4*3+ sharedVideoHeight*2,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        };\r\n    }\r\n    else {\r\n        return{\r\n            left: (parentw-sharedVideoWidth*2)/3*1.5+sharedVideoWidth/2,\r\n            top:  (parenth -sharedVideoHeight*2)/3*2+ sharedVideoHeight,\r\n            width: sharedVideoWidth,\r\n            height: sharedVideoHeight\r\n        }\r\n    }\r\n}\r\n\r\n\r\n function reshape1of4(parentw, parenth) {\r\n    return {\r\n        left: (parentw - sharedVideoWidth*2)/3,\r\n        top: (parenth - sharedVideoHeight*2)/3,\r\n        width: sharedVideoWidth,\r\n        height: sharedVideoHeight\r\n    }\r\n}\r\n\r\n function reshape2of4(parentw, parenth) {\r\n    return {\r\n        left: (parentw - sharedVideoWidth*2)/3*2+ sharedVideoWidth,\r\n        top: (parenth - sharedVideoHeight*2)/3,\r\n        width: sharedVideoWidth,\r\n        height: sharedVideoHeight\r\n    }\r\n}\r\n function reshape3of4(parentw, parenth) {\r\n    return {\r\n        left: (parentw - sharedVideoWidth*2)/3,\r\n        top: (parenth - sharedVideoHeight*2)/3*2 + sharedVideoHeight,\r\n        width: sharedVideoWidth,\r\n        height: sharedVideoHeight\r\n    }\r\n}\r\n\r\n function reshape4of4(parentw, parenth) {\r\n    return {\r\n        left: (parentw - sharedVideoWidth*2)/3*2 + sharedVideoWidth,\r\n        top: (parenth - sharedVideoHeight*2)/3*2 + sharedVideoHeight,\r\n        width: sharedVideoWidth,\r\n        height: sharedVideoHeight\r\n    }\r\n}\r\n\r\nvar boxUsed = [true, false, false, false];\r\nvar connectCount = 0;\r\n\r\n\r\n function setSharedVideoSize(parentw, parenth) {\r\n    layout = ((parentw /aspectRatio) < parenth)?'p':'l';\r\n    var w, h;\r\n\r\n     function sizeBy(fullsize, numVideos) {\r\n        return (fullsize - margin*(numVideos+1) )/numVideos;\r\n    }\r\n\r\n    switch(layout+(connectCount+1)) {\r\n        case 'p1':\r\n        case 'l1':\r\n            w = sizeBy(parentw, 1);\r\n            h = sizeBy(parenth, 1);\r\n            break;\r\n        case 'l2':\r\n            w = sizeBy(parentw, 2);\r\n            h = sizeBy(parenth, 1);\r\n            break;\r\n        case 'p2':\r\n            w = sizeBy(parentw, 1);\r\n            h = sizeBy(parenth, 2);\r\n            break;\r\n        case 'p4':\r\n        case 'l4':\r\n        case 'l3':\r\n            w = sizeBy(parentw, 2);\r\n            h = sizeBy(parenth, 2);\r\n            break;\r\n        case 'p3':\r\n            w = sizeBy(parentw, 1);\r\n            h = sizeBy(parenth, 3);\r\n            break;\r\n    }\r\n    sharedVideoWidth = Math.min(w, h * aspectRatio);\r\n    sharedVideoHeight = Math.min(h, w/aspectRatio);\r\n}\r\n\r\nvar reshapeThumbs = [\r\n     function(parentw, parenth) {\r\n\r\n        if( activeBox > 0 ) {\r\n            return setThumbSize(0.20, 0.01, 0.01, parentw, parenth);\r\n        }\r\n        else {\r\n            setSharedVideoSize(parentw, parenth)\r\n            switch(connectCount) {\r\n                case 0:return reshapeToFullSize(parentw, parenth);\r\n                case 1:return reshape1of2(parentw, parenth);\r\n                case 2:return reshape1of3(parentw, parenth);\r\n                case 3:return reshape1of4(parentw, parenth);\r\n            }\r\n        }\r\n    },\r\n     function(parentw, parenth) {\r\n        if( activeBox >= 0 || !boxUsed[1]) {\r\n            return setThumbSize(0.20, 0.01, -0.01, parentw, parenth);\r\n        }\r\n        else{\r\n            switch(connectCount) {\r\n                case 1:\r\n                    return reshape2of2(parentw, parenth);\r\n                case 2:\r\n                    return reshape2of3(parentw, parenth);\r\n                case 3:\r\n                    return reshape2of4(parentw, parenth);\r\n            }\r\n        }\r\n    },\r\n     function(parentw, parenth) {\r\n        if( activeBox >= 0 || !boxUsed[2] ) {\r\n            return setThumbSize(0.20, -0.01, 0.01, parentw, parenth);\r\n        }\r\n        else  {\r\n            switch(connectCount){\r\n                case 1:\r\n                    return reshape2of2(parentw, parenth);\r\n                case 2:\r\n                    if( !boxUsed[1]) {\r\n                        return reshape2of3(parentw, parenth);\r\n                    }\r\n                    else {\r\n                        return reshape3of3(parentw, parenth);\r\n                    }\r\n                /* falls through */\r\n                case 3:\r\n                    return reshape3of4(parentw, parenth);\r\n            }\r\n        }\r\n    },\r\n     function(parentw, parenth) {\r\n        if( activeBox >= 0 || !boxUsed[3]) {\r\n            return setThumbSize(0.20, -0.01, -0.01, parentw, parenth);\r\n        }\r\n        else{\r\n            switch(connectCount){\r\n                case 1:\r\n                    return reshape2of2(parentw, parenth);\r\n                case 2:\r\n                    return reshape3of3(parentw, parenth);\r\n                case 3:\r\n                    return reshape4of4(parentw, parenth);\r\n            }\r\n        }\r\n    },\r\n];\r\n\r\n\r\n function killButtonReshaper(parentw, parenth) {\r\n    var imagew = 128;\r\n    var imageh = 128;\r\n    if( parentw < parenth) {\r\n        return setThumbSizeButton(0.1, -0.51, -0.01, parentw, parenth, imagew, imageh);\r\n    }\r\n    else {\r\n        return setThumbSizeButton(0.1, -0.01, -0.51, parentw, parenth, imagew, imageh);\r\n    }\r\n}\r\n\r\n\r\n function muteButtonReshaper(parentw, parenth) {\r\n    var imagew = 32;\r\n    var imageh = 32;\r\n    if( parentw < parenth) {\r\n        return setThumbSizeButton(0.10, -0.51, 0.01, parentw, parenth, imagew, imageh);\r\n    }\r\n    else {\r\n        return setThumbSizeButton(0.10, 0.01, -0.51, parentw, parenth, imagew, imageh);\r\n    }\r\n}\r\n\r\n function reshapeTextEntryButton(parentw, parenth) {\r\n    var imagew = 32;\r\n    var imageh = 32;\r\n    if( parentw < parenth) {\r\n        return setThumbSizeButton(0.10, 0.51, 0.01, parentw, parenth, imagew, imageh);\r\n    }\r\n    else {\r\n        return setThumbSizeButton(0.10, 0.01, 0.51, parentw, parenth, imagew, imageh);\r\n    }\r\n}\r\n\r\n\r\n function handleWindowResize() {\r\n    var fullpage = document.getElementById('fullpage');\r\n    fullpage.style.width = window.innerWidth + \"px\";\r\n    fullpage.style.height = window.innerHeight + \"px\";\r\n    connectCount = easyrtc.getConnectionCount();\r\n\r\n     function applyReshape(obj,  parentw, parenth) {\r\n        var myReshape = obj.reshapeMe(parentw, parenth);\r\n\r\n        if(typeof myReshape.left !== 'undefined' ) {\r\n            obj.style.left = Math.round(myReshape.left) + \"px\";\r\n        }\r\n        if(typeof myReshape.top !== 'undefined' ) {\r\n            obj.style.top = Math.round(myReshape.top) + \"px\";\r\n        }\r\n        if(typeof myReshape.width !== 'undefined' ) {\r\n            obj.style.width = Math.round(myReshape.width) + \"px\";\r\n        }\r\n        if(typeof myReshape.height !== 'undefined' ) {\r\n            obj.style.height = Math.round(myReshape.height) + \"px\";\r\n        }\r\n\r\n        var n = obj.childNodes.length;\r\n        for(var i = 0; i < n; i++ ) {\r\n            var childNode = obj.childNodes[i];\r\n            if( childNode.reshapeMe) {\r\n                applyReshape(childNode, myReshape.width, myReshape.height);\r\n            }\r\n        }\r\n    }\r\n\r\n    applyReshape(fullpage, window.innerWidth, window.innerHeight);\r\n}\r\n\r\n\r\n function setReshaper(elementId, reshapeFn) {\r\n    var element = document.getElementById(elementId);\r\n    if( !element) {\r\n        alert(\"Attempt to apply to reshapeFn to non-existent element \" + elementId);\r\n    }\r\n    if( !reshapeFn) {\r\n        alert(\"Attempt to apply misnamed reshapeFn to element \" + elementId);\r\n    }\r\n    element.reshapeMe = reshapeFn;\r\n}\r\n\r\n\r\n function collapseToThumbHelper() {\r\n    if( activeBox >= 0) {\r\n        var id = getIdOfBox(activeBox);\r\n        document.getElementById(id).style.zIndex = 2;\r\n        setReshaper(id, reshapeThumbs[activeBox]);\r\n        document.getElementById('muteButton').style.display = \"none\";\r\n        document.getElementById('killButton').style.display = \"none\";\r\n        activeBox = -1;\r\n    }\r\n}\r\n\r\n function collapseToThumb() {\r\n    collapseToThumbHelper();\r\n    activeBox = -1;\r\n    updateMuteImage(false);\r\n    handleWindowResize();\r\n\r\n}\r\n\r\n function updateMuteImage(toggle) {\r\n    var muteButton = document.getElementById('muteButton');\r\n    if( activeBox > 0) { // no kill button for self video\r\n        muteButton.style.display = \"block\";\r\n        var videoObject = document.getElementById( getIdOfBox(activeBox));\r\n        var isMuted = videoObject.muted?true:false;\r\n        if( toggle) {\r\n            isMuted = !isMuted;\r\n            videoObject.muted = isMuted;\r\n        }\r\n        muteButton.src = isMuted?\"images/button_unmute.png\":\"images/button_mute.png\";\r\n    }\r\n    else {\r\n        muteButton.style.display = \"none\";\r\n    }\r\n}\r\n\r\n\r\n function expandThumb(whichBox) {\r\n    var lastActiveBox = activeBox;\r\n    if( activeBox >= 0 ) {\r\n        collapseToThumbHelper();\r\n    }\r\n    if( lastActiveBox != whichBox) {\r\n        var id = getIdOfBox(whichBox);\r\n        activeBox = whichBox;\r\n        setReshaper(id, reshapeToFullSize);\r\n        document.getElementById(id).style.zIndex = 1;\r\n        if( whichBox > 0) {\r\n            document.getElementById('muteButton').style.display = \"block\";\r\n            updateMuteImage();\r\n            document.getElementById('killButton').style.display = \"block\";\r\n        }\r\n    }\r\n    updateMuteImage(false);\r\n    handleWindowResize();\r\n}\r\n\r\n function prepVideoBox(whichBox) {\r\n    var id = getIdOfBox(whichBox);\r\n    setReshaper(id, reshapeThumbs[whichBox]);\r\n    document.getElementById(id).onclick =  function() {\r\n        expandThumb(whichBox);\r\n    };\r\n}\r\n\r\n\r\n function killActiveBox() {\r\n    if( activeBox > 0) {\r\n        var easyrtcid = easyrtc.getIthCaller(activeBox-1);\r\n        collapseToThumb();\r\n        setTimeout(  function() {\r\n            easyrtc.hangup(easyrtcid);\r\n        }, 400);\r\n    }\r\n}\r\n\r\n\r\n function muteActiveBox() {\r\n    updateMuteImage(true);\r\n}\r\n\r\n\r\n\r\n\r\n function callEverybodyElse(roomName, otherPeople) {\r\n\r\n    easyrtc.setRoomOccupantListener(null); // so we're only called once.\r\n\r\n    var list = [];\r\n    var connectCount = 0;\r\n    for(var easyrtcid in otherPeople ) {\r\n        list.push(easyrtcid);\r\n    }\r\n    //\r\n    // Connect in reverse order. Latter arriving people are more likely to have\r\n    // empty slots.\r\n    //\r\n     function establishConnection(position) {\r\n         function callSuccess() {\r\n            connectCount++;\r\n            if( connectCount < maxCALLERS && position > 0) {\r\n                establishConnection(position-1);\r\n            }\r\n        }\r\n         function callFailure(errorCode, errorText) {\r\n            easyrtc.showError(errorCode, errorText);\r\n            if( connectCount < maxCALLERS && position > 0) {\r\n                establishConnection(position-1);\r\n            }\r\n        }\r\n        easyrtc.call(list[position], callSuccess, callFailure);\r\n\r\n    }\r\n    if( list.length > 0) {\r\n        establishConnection(list.length-1);\r\n    }\r\n}\r\n\r\n\r\n function loginSuccess() {\r\n    expandThumb(0);  // expand the mirror image initially.\r\n}\r\n\r\n\r\n function cancelText() {\r\n    document.getElementById('textentryBox').style.display = \"none\";\r\n    document.getElementById('textEntryButton').style.display = \"block\";\r\n}\r\n\r\n\r\n function sendText(e) {\r\n    document.getElementById('textentryBox').style.display = \"none\";\r\n    document.getElementById('textEntryButton').style.display = \"block\";\r\n    var stringToSend = document.getElementById('textentryField').value;\r\n    if( stringToSend && stringToSend != \"\") {\r\n        for(var i = 0; i < maxCALLERS; i++ ) {\r\n            var easyrtcid = easyrtc.getIthCaller(i);\r\n            if( easyrtcid && easyrtcid != \"\") {\r\n                easyrtc.sendPeerMessage(easyrtcid, \"im\",  stringToSend);\r\n            }\r\n        }\r\n    }\r\n    return false;\r\n}\r\n\r\n\r\n function showTextEntry() {\r\n    document.getElementById('textentryField').value = \"\";\r\n    document.getElementById('textentryBox').style.display = \"block\";\r\n    document.getElementById('textEntryButton').style.display = \"none\";\r\n    document.getElementById('textentryField').focus();\r\n}\r\n\r\n\r\n function showMessage(startX, startY, content) {\r\n    var fullPage = document.getElementById('fullpage');\r\n    var fullW = parseInt(fullPage.offsetWidth);\r\n    var fullH = parseInt(fullPage.offsetHeight);\r\n    var centerEndX = 0.2*startX + 0.8*fullW/2;\r\n    var centerEndY = 0.2*startY + 0.8*fullH/2;\r\n\r\n\r\n    var cloudObject = document.createElement(\"img\");\r\n    cloudObject.src = \"images/cloud.png\";\r\n    cloudObject.style.width = \"1px\";\r\n    cloudObject.style.height = \"1px\";\r\n    cloudObject.style.left = startX + \"px\";\r\n    cloudObject.style.top = startY + \"px\";\r\n    fullPage.appendChild(cloudObject);\r\n\r\n    cloudObject.onload =  function() {\r\n        cloudObject.style.left = startX + \"px\";\r\n        cloudObject.style.top = startY + \"px\";\r\n        cloudObject.style.width = \"4px\";\r\n        cloudObject.style.height = \"4px\";\r\n        cloudObject.style.opacity = 0.7;\r\n        cloudObject.style.zIndex = 5;\r\n        cloudObject.className = \"transit boxCommon\";\r\n        var textObject;\r\n         function removeCloud() {\r\n            if( textObject) {\r\n                fullPage.removeChild(textObject);\r\n                fullPage.removeChild(cloudObject);\r\n            }\r\n        }\r\n        setTimeout( function() {\r\n            cloudObject.style.left = centerEndX - fullW/4 + \"px\";\r\n            cloudObject.style.top = centerEndY - fullH/4+ \"px\";\r\n            cloudObject.style.width = (fullW/2) + \"px\";\r\n            cloudObject.style.height = (fullH/2) + \"px\";\r\n        }, 10);\r\n        setTimeout( function() {\r\n            textObject = document.createElement('div');\r\n            textObject.className = \"boxCommon\";\r\n            textObject.style.left = Math.floor(centerEndX-fullW/8) + \"px\";\r\n            textObject.style.top = Math.floor(centerEndY) + \"px\";\r\n            textObject.style.fontSize = \"36pt\";\r\n            textObject.style.width = (fullW*0.4) + \"px\";\r\n            textObject.style.height = (fullH*0.4) + \"px\";\r\n            textObject.style.zIndex = 6;\r\n            textObject.appendChild( document.createTextNode(content));\r\n            fullPage.appendChild(textObject);\r\n            textObject.onclick = removeCloud;\r\n            cloudObject.onclick = removeCloud;\r\n        }, 1000);\r\n        setTimeout( function() {\r\n            cloudObject.style.left = startX + \"px\";\r\n            cloudObject.style.top = startY + \"px\";\r\n            cloudObject.style.width = \"4px\";\r\n            cloudObject.style.height = \"4px\";\r\n            fullPage.removeChild(textObject);\r\n        }, 9000);\r\n        setTimeout( function(){\r\n            fullPage.removeChild(cloudObject);\r\n        }, 10000);\r\n    }\r\n}\r\n\r\n function messageListener(easyrtcid, msgType, content) {\r\n    for(var i = 0; i < maxCALLERS; i++) {\r\n        if( easyrtc.getIthCaller(i) == easyrtcid) {\r\n            var startArea = document.getElementById(getIdOfBox(i+1));\r\n            var startX = parseInt(startArea.offsetLeft) + parseInt(startArea.offsetWidth)/2;\r\n            var startY = parseInt(startArea.offsetTop) + parseInt(startArea.offsetHeight)/2;\r\n            showMessage(startX, startY, content);\r\n        }\r\n    }\r\n}\r\n\r\n\r\n function appInit() {\r\n\r\n    // Prep for the top-down layout manager\r\n    setReshaper('fullpage', reshapeFull);\r\n    for(var i = 0; i < numVideoOBJS; i++) {\r\n        prepVideoBox(i);\r\n    }\r\n    setReshaper('killButton', killButtonReshaper);\r\n    setReshaper('muteButton', muteButtonReshaper);\r\n    setReshaper('textentryBox', reshapeTextEntryBox);\r\n    setReshaper('textentryField', reshapeTextEntryField);\r\n    setReshaper('textEntryButton', reshapeTextEntryButton);\r\n\r\n    updateMuteImage(false);\r\n    window.onresize = handleWindowResize;\r\n    handleWindowResize(); //initial call of the top-down layout manager\r\n\r\n\r\n    easyrtc.setRoomOccupantListener(callEverybodyElse);\r\n    easyrtc.easyApp(\"easyrtc.multiparty\", \"box0\", [\"box1\", \"box2\", \"box3\"], loginSuccess);\r\n    easyrtc.setPeerListener(messageListener);\r\n    easyrtc.setDisconnectListener(  function() {\r\n        easyrtc.showError(\"LOST-CONNECTION\", \"Lost connection to signaling server\");\r\n    });\r\n\tvar box0=document.getElementById('box0');\r\n\tvar canvas0=document.getElementById('canvas0');\r\n\t//bindPage(box0,canvas0);\r\n    easyrtc.setOnCall(  function(easyrtcid, slot) {\r\n        console.log(\"getConnection count=\"  + easyrtc.getConnectionCount() );\r\n        boxUsed[slot+1] = true;\r\n        if(activeBox == 0 ) { // first connection\r\n            collapseToThumb();\r\n            document.getElementById('textEntryButton').style.display = 'block';\r\n        }\r\n        document.getElementById(getIdOfBox(slot+1)).style.visibility = \"visible\";\r\n\t\t\r\n        handleWindowResize();\r\n    });\r\n\r\n\r\n    easyrtc.setOnHangup( function(easyrtcid, slot) {\r\n        boxUsed[slot+1] = false;\r\n        if(activeBox > 0 && slot+1 == activeBox) {\r\n            collapseToThumb();\r\n        }\r\n        setTimeout( function() {\r\n            document.getElementById(getIdOfBox(slot+1)).style.visibility = \"hidden\";\r\n\r\n            if( easyrtc.getConnectionCount() == 0 ) { // no more connections\r\n                expandThumb(0);\r\n                document.getElementById('textEntryButton').style.display = 'none';\r\n                document.getElementById('textentryBox').style.display = 'none';\r\n            }\r\n            handleWindowResize();\r\n        },20);\r\n    });\r\n}\r\n\r\n\r\n"]}